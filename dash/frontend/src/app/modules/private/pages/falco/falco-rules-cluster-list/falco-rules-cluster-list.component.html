<mat-card class="card">
  <mat-card-header>
    <mat-card-title class="falco-title">
      <h1>Rules</h1>
      <button mat-raised-button color="primary"
      [routerLink]="['/private','falco']">
        Manage Falco Rules
      </button>
    </mat-card-title>
  </mat-card-header>
  <mat-card-content class="falco-rule-card-content">
    <div class="row w-100">
      <div class="col w-100" *ngFor="let rule of rules; index as idx">
      <div class="rule-container">
        <strong>{{rule.action | titlecase}}</strong> when the following are true:
        <div class="pl-10">
          <ng-container *ngIf="!rule.allNamespaces">
            <p>
              Event is from <strong>certain namespaces,</strong> including: {{ rule.namespaces | arrayText : { elements: 3, key: 'namespace'} }}
            </p>
          </ng-container>

          <ng-container *ngIf="!rule.allClusters">
            <p>
              Event is from <strong>certain clusters,</strong> including: {{ rule.clusters | arrayText : { elements: 3, key: 'name'} }}
            </p>
          </ng-container>
          <p *ngIf="!!rule.image">
            Image matches: <strong>{{ rule.image }}</strong>
          </p>
          <p *ngIf="!!rule.falcoRule">
            Falco rule matches: <strong>{{ rule.falcoRule }}</strong>
          </p>
        </div>
      </div>
    </div>
    </div>
  </mat-card-content>
</mat-card>
